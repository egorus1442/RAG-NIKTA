# ๐ ะะฝัะพัะผะฐัะธั ะพ ะฟัะพะตะบัะต RAG API

## ะะฟะธัะฐะฝะธะต

RAG API - ััะพ ะผะธะฝะธะผะฐะปะธััะธัะฝะพะต, ะฝะพ ะฟะพะปะฝะพัััั ััะฝะบัะธะพะฝะฐะปัะฝะพะต REST-API ะดะปั Retrieval-Augmented Generation (RAG) ะฝะฐ Python. ะัะพะตะบั ัะตะฐะปะธะทัะตั ะฟะพะปะฝัะน ัะธะบะป ัะฐะฑะพัั ั ะดะพะบัะผะตะฝัะฐะผะธ: ะทะฐะณััะทะบะฐ, ะพะฑัะฐะฑะพัะบะฐ, ะธะฝะดะตะบัะฐัะธั ะธ ะณะตะฝะตัะฐัะธั ะพัะฒะตัะพะฒ ะฝะฐ ะพัะฝะพะฒะต ะบะพะฝัะตะบััะฐ.

## ะะพะทะผะพะถะฝะพััะธ

- ๐ ะะฐะณััะทะบะฐ ะดะพะบัะผะตะฝัะพะฒ (PDF, DOCX, TXT)
- ๐ ะะทะฒะปะตัะตะฝะธะต ัะตะบััะฐ ะธ ัะฐะทะฑะธะฒะบะฐ ะฝะฐ ัะฐะฝะบะธ
- ๐ง ะะตะฝะตัะฐัะธั ัะผะฑะตะดะธะฝะณะพะฒ ัะตัะตะท OpenAI API
- ๐พ ะฅัะฐะฝะตะฝะธะต ัะผะฑะตะดะธะฝะณะพะฒ ะฒ ChromaDB (SQLite)
- ๐ ะกะตะผะฐะฝัะธัะตัะบะธะน ะฟะพะธัะบ ะฟะพ ะดะพะบัะผะตะฝัะฐะผ
- ๐ค ะะตะฝะตัะฐัะธั ะพัะฒะตัะพะฒ ัะตัะตะท OpenRouter API
- ๐ ะััะตะฝัะธัะธะบะฐัะธั ะฟะพ API ัะพะบะตะฝั

## ะััะธัะตะบัััะฐ

### ะัะฝะพะฒะฝัะต ะบะพะผะฟะพะฝะตะฝัั

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   FastAPI App   โ    โ   Text Extractorโ    โ  Embeddings     โ
โ   (main.py)     โโโโโบโ   (utils/)      โโโโโบโ  Service        โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
         โ                       โ                       โ
         โผ                       โผ                       โผ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   Auth Module   โ    โ   File Storage  โ    โ   ChromaDB      โ
โ   (auth.py)     โ    โ   (uploads/)    โ    โ   (SQLite)      โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
         โ                       โ                       โ
         โผ                       โผ                       โผ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   LLM Service   โ    โ   Config        โ    โ   Models        โ
โ   (OpenRouter)  โ    โ   (config.py)   โ    โ   (models.py)   โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
```

### ะะพัะพะบ ะดะฐะฝะฝัั

1. **ะะฐะณััะทะบะฐ ัะฐะนะปะฐ** (`POST /upload`)
   - ะคะฐะนะป ัะพััะฐะฝัะตััั ะฝะฐ ะดะธัะบ
   - ะขะตะบัั ะธะทะฒะปะตะบะฐะตััั ัะตัะตะท `TextExtractor`
   - ะขะตะบัั ัะฐะทะฑะธะฒะฐะตััั ะฝะฐ ัะฐะฝะบะธ
   - ะญะผะฑะตะดะธะฝะณะธ ะณะตะฝะตัะธัััััั ัะตัะตะท OpenAI API
   - ะญะผะฑะตะดะธะฝะณะธ ัะพััะฐะฝััััั ะฒ ChromaDB

2. **ะะพะธัะบ ะธ ะณะตะฝะตัะฐัะธั** (`POST /query`)
   - ะะฐะฟัะพั ะฟัะตะพะฑัะฐะทัะตััั ะฒ ัะผะฑะตะดะธะฝะณ
   - ChromaDB ะฝะฐัะพะดะธั ะฟะพัะพะถะธะต ะดะพะบัะผะตะฝัั
   - ะะพะฝัะตะบัั ัะพัะผะธััะตััั ะธะท ะฝะฐะนะดะตะฝะฝัั ะดะพะบัะผะตะฝัะพะฒ
   - OpenRouter ะณะตะฝะตัะธััะตั ะพัะฒะตั ะฝะฐ ะพัะฝะพะฒะต ะบะพะฝัะตะบััะฐ

3. **ะฃะดะฐะปะตะฝะธะต ัะฐะนะปะฐ** (`DELETE /file/{file_id}`)
   - ะคะฐะนะป ัะดะฐะปัะตััั ั ะดะธัะบะฐ
   - ะญะผะฑะตะดะธะฝะณะธ ัะดะฐะปััััั ะธะท ChromaDB

## ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ

### ะัะฝะพะฒะฝัะต ัะตัะฝะพะปะพะณะธะธ
- **FastAPI** - ัะพะฒัะตะผะตะฝะฝัะน ะฒะตะฑ-ััะตะนะผะฒะพัะบ ะดะปั Python
- **ChromaDB** - ะฒะตะบัะพัะฝะฐั ะฑะฐะทะฐ ะดะฐะฝะฝัั ะดะปั ััะฐะฝะตะฝะธั ัะผะฑะตะดะธะฝะณะพะฒ
- **SQLite** - ะฑะฐะทะพะฒะฐั ะกะฃะะ ะดะปั ChromaDB
- **OpenAI API** - ะณะตะฝะตัะฐัะธั ัะผะฑะตะดะธะฝะณะพะฒ (text-embedding-ada-002)
- **OpenRouter API** - ะณะตะฝะตัะฐัะธั ะพัะฒะตัะพะฒ (gpt-4o-mini)

### ะะธะฑะปะธะพัะตะบะธ ะดะปั ะพะฑัะฐะฑะพัะบะธ ัะฐะนะปะพะฒ
- **PyMuPDF** - ะธะทะฒะปะตัะตะฝะธะต ัะตะบััะฐ ะธะท PDF
- **python-docx** - ะธะทะฒะปะตัะตะฝะธะต ัะตะบััะฐ ะธะท DOCX
- **python-multipart** - ะพะฑัะฐะฑะพัะบะฐ ะทะฐะณััะทะบะธ ัะฐะนะปะพะฒ

### ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะฑะธะฑะปะธะพัะตะบะธ
- **pydantic** - ะฒะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั
- **python-dotenv** - ัะฟัะฐะฒะปะตะฝะธะต ะฟะตัะตะผะตะฝะฝัะผะธ ะพะบััะถะตะฝะธั
- **uvicorn** - ASGI ัะตัะฒะตั

## ะกัััะบัััะฐ ะบะพะดะฐ

### ะะพะดัะปะธ

#### `main.py` - ะัะฝะพะฒะฝะพะต ะฟัะธะปะพะถะตะฝะธะต
- ะะฟัะตะดะตะปะตะฝะธะต FastAPI ะฟัะธะปะพะถะตะฝะธั
- ะญะฝะดะฟะพะธะฝัั API
- ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ
- Middleware

#### `config.py` - ะะพะฝัะธะณััะฐัะธั
- ะะฐะณััะทะบะฐ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั
- ะะฐัััะพะนะบะธ ะฟัะธะปะพะถะตะฝะธั
- ะกะพะทะดะฐะฝะธะต ะดะธัะตะบัะพัะธะน

#### `auth.py` - ะััะตะฝัะธัะธะบะฐัะธั
- ะัะพะฒะตัะบะฐ API ัะพะบะตะฝะพะฒ
- Middleware ะดะปั ะทะฐัะธัั ัะฝะดะฟะพะธะฝัะพะฒ

#### `models.py` - ะะพะดะตะปะธ ะดะฐะฝะฝัั
- Pydantic ะผะพะดะตะปะธ ะดะปั ะฒะฐะปะธะดะฐัะธะธ
- ะกัะตะผั ะทะฐะฟัะพัะพะฒ ะธ ะพัะฒะตัะพะฒ

#### `utils/text_extractor.py` - ะะทะฒะปะตัะตะฝะธะต ัะตะบััะฐ
- ะะพะดะดะตัะถะบะฐ PDF, DOCX, TXT
- ะะฐะทะฑะธะฒะบะฐ ัะตะบััะฐ ะฝะฐ ัะฐะฝะบะธ
- ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ

#### `services/embeddings_service.py` - ะะฐะฑะพัะฐ ั ัะผะฑะตะดะธะฝะณะฐะผะธ
- ะะฝัะตะณัะฐัะธั ั OpenAI API
- ะฃะฟัะฐะฒะปะตะฝะธะต ChromaDB
- ะะพะธัะบ ะฟะพัะพะถะธั ะดะพะบัะผะตะฝัะพะฒ

#### `services/llm_service.py` - ะะตะฝะตัะฐัะธั ะพัะฒะตัะพะฒ
- ะะฝัะตะณัะฐัะธั ั OpenRouter API
- ะคะพัะผะธัะพะฒะฐะฝะธะต ะฟัะพะผะฟัะพะฒ
- ะะฑัะฐะฑะพัะบะฐ ะบะพะฝัะตะบััะฐ

## API Endpoints

### ะััะตะฝัะธัะธะบะฐัะธั
ะัะต ัะฝะดะฟะพะธะฝัั ััะตะฑััั ะทะฐะณะพะปะพะฒะพะบ `Authorization: Bearer <API_TOKEN>`

### ะัะฝะพะฒะฝัะต ัะฝะดะฟะพะธะฝัั

1. **POST /upload** - ะะฐะณััะทะบะฐ ัะฐะนะปะฐ
   - ะัะธะฝะธะผะฐะตั multipart/form-data
   - ะะพะดะดะตัะถะธะฒะฐะตั PDF, DOCX, TXT
   - ะะพะทะฒัะฐัะฐะตั file_id ะธ ะผะตัะฐะดะฐะฝะฝัะต

2. **POST /query** - ะะฐะฟัะพั ะบ ะดะพะบัะผะตะฝัะฐะผ
   - ะัะธะฝะธะผะฐะตั JSON ั ะฒะพะฟัะพัะพะผ
   - ะัะฟะพะปะฝัะตั ัะตะผะฐะฝัะธัะตัะบะธะน ะฟะพะธัะบ
   - ะะตะฝะตัะธััะตั ะพัะฒะตั ะฝะฐ ะพัะฝะพะฒะต ะบะพะฝัะตะบััะฐ

3. **DELETE /file/{file_id}** - ะฃะดะฐะปะตะฝะธะต ัะฐะนะปะฐ
   - ะฃะดะฐะปัะตั ัะฐะนะป ะธ ัะผะฑะตะดะธะฝะณะธ
   - ะะพะทะฒัะฐัะฐะตั ะฟะพะดัะฒะตัะถะดะตะฝะธะต

4. **GET /health** - ะัะพะฒะตัะบะฐ ัะพััะพัะฝะธั
   - ะะพะฝะธัะพัะธะฝะณ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ API

## ะะพะฝัะธะณััะฐัะธั

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

| ะะตัะตะผะตะฝะฝะฐั | ะะฟะธัะฐะฝะธะต | ะะพ ัะผะพะปัะฐะฝะธั |
|------------|----------|--------------|
| `OPENAI_API_KEY` | ะะปัั OpenAI ะดะปั ัะผะฑะตะดะธะฝะณะพะฒ | - |
| `OPENROUTER_API_KEY` | ะะปัั OpenRouter ะดะปั ะณะตะฝะตัะฐัะธะธ | - |
| `API_TOKEN` | ะขะพะบะตะฝ ะดะปั ะฐััะตะฝัะธัะธะบะฐัะธะธ API | - |
| `UPLOAD_DIR` | ะะธัะตะบัะพัะธั ะดะปั ัะฐะนะปะพะฒ | `uploads` |
| `CHUNK_SIZE` | ะะฐะทะผะตั ัะฐะฝะบะฐ ัะตะบััะฐ | `1000` |
| `CHUNK_OVERLAP` | ะะตัะตะบัััะธะต ัะฐะฝะบะพะฒ | `200` |
| `TOP_K` | ะะพะปะธัะตััะฒะพ ะฟะพัะพะถะธั ะดะพะบัะผะตะฝัะพะฒ | `5` |

### ะะฐัััะพะนะบะธ ChromaDB
- ะััั ะบ ะฑะฐะทะต ะดะฐะฝะฝัั: `./chroma_db`
- ะะพะปะปะตะบัะธั: `documents`
- ะะตััะธะบะฐ ัะฐัััะพัะฝะธั: `cosine`

## ะะตะทะพะฟะฐัะฝะพััั

### ะััะตะฝัะธัะธะบะฐัะธั
- Bearer token ะฐััะตะฝัะธัะธะบะฐัะธั
- ะัะต ัะฝะดะฟะพะธะฝัั ะทะฐัะธัะตะฝั
- ะขะพะบะตะฝ ะฝะฐัััะฐะธะฒะฐะตััั ัะตัะตะท ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั

### ะะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั
- Pydantic ะผะพะดะตะปะธ ะดะปั ะฒัะตั ะทะฐะฟัะพัะพะฒ
- ะัะพะฒะตัะบะฐ ัะธะฟะพะฒ ัะฐะนะปะพะฒ
- ะะฐะปะธะดะฐัะธั ัะฐะทะผะตัะฐ ัะฐะนะปะพะฒ

### ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ
- ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะธัะบะปััะตะฝะธะน
- ะกัััะบัััะธัะพะฒะฐะฝะฝัะต ะพัะฒะตัั ะพะฑ ะพัะธะฑะบะฐั
- ะะพะณะธัะพะฒะฐะฝะธะต ะพัะธะฑะพะบ

## ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

### ะะฟัะธะผะธะทะฐัะธะธ
- ะัะธะฝััะพะฝะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะทะฐะฟัะพัะพะฒ
- ะััะธัะพะฒะฐะฝะธะต ัะผะฑะตะดะธะฝะณะพะฒ ะฒ ChromaDB
- ะญััะตะบัะธะฒะฝะฐั ัะฐะทะฑะธะฒะบะฐ ัะตะบััะฐ ะฝะฐ ัะฐะฝะบะธ
- ะะฐัะฐะปะปะตะปัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ัะฐะนะปะพะฒ

### ะะฐัััะฐะฑะธััะตะผะพััั
- ะะพะดัะปัะฝะฐั ะฐััะธัะตะบัััะฐ
- ะะฐะทะดะตะปะตะฝะธะต ะพัะฒะตัััะฒะตะฝะฝะพััะธ
- ะะพะทะผะพะถะฝะพััั ะทะฐะผะตะฝั ะบะพะผะฟะพะฝะตะฝัะพะฒ
- ะะพะดะดะตัะถะบะฐ ัะฐะทะปะธัะฝัั ะฟัะพะฒะฐะนะดะตัะพะฒ LLM

## ะะพะฝะธัะพัะธะฝะณ ะธ ะปะพะณะธัะพะฒะฐะฝะธะต

### Health Check
- ะญะฝะดะฟะพะธะฝั `/health` ะดะปั ะผะพะฝะธัะพัะธะฝะณะฐ
- ะัะพะฒะตัะบะฐ ะดะพัััะฟะฝะพััะธ ัะตัะฒะธัะพะฒ
- ะกัะฐััั ะฑะฐะทั ะดะฐะฝะฝัั

### ะะพะณะธัะพะฒะฐะฝะธะต
- Uvicorn ะปะพะณะธ ะดะปั HTTP ะทะฐะฟัะพัะพะฒ
- ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ ั ะดะตัะฐะปัะผะธ
- ะัะปะฐะดะพัะฝะฐั ะธะฝัะพัะผะฐัะธั

## ะะฐะทะฒะตัััะฒะฐะฝะธะต

### ะะพะบะฐะปัะฝะฐั ัะฐะทัะฐะฑะพัะบะฐ
```bash
python run.py
```

### ะัะพะดะฐะบัะฝ
```bash
uvicorn main:app --host 0.0.0.0 --port 8000 --workers 4
```

### Docker (ะฟะปะฐะฝะธััะตััั)
- Dockerfile ะดะปั ะบะพะฝัะตะนะฝะตัะธะทะฐัะธะธ
- docker-compose ะดะปั ะพัะบะตัััะฐัะธะธ
- ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั ัะตัะตะท Docker

## ะขะตััะธัะพะฒะฐะฝะธะต

### ะะฒัะพะผะฐัะธัะตัะบะธะต ัะตััั
- `test_api.py` - ะธะฝัะตะณัะฐัะธะพะฝะฝัะต ัะตััั
- ะัะพะฒะตัะบะฐ ะฒัะตั ัะฝะดะฟะพะธะฝัะพะฒ
- ะขะตััะธัะพะฒะฐะฝะธะต ะพะฑัะฐะฑะพัะบะธ ะพัะธะฑะพะบ

### ะััะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต
- Swagger UI: http://localhost:8000/docs
- curl ะบะพะผะฐะฝะดั ะฒ ะดะพะบัะผะตะฝัะฐัะธะธ
- ะัะธะผะตัั ะฒ README


## ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะะฐะณััะทะบะฐ ัะฐะนะปะฐ
```bash
curl -X POST "http://localhost:8000/upload" \
  -H "Authorization: Bearer your_token" \
  -F "file=@document.pdf"
```

### ะะฐะฟัะพั ะบ API
```bash
curl -X POST "http://localhost:8000/query" \
  -H "Authorization: Bearer your_token" \
  -H "Content-Type: application/json" \
  -d '{"question": "ะงัะพ ัะฐะบะพะต ะะ?"}'
```
